{% extends "base.html" %}

{% block content %}
<div class="container">
    <img src="/static/logo.png" alt="Node Logo" class="logo">
    <h1 class="title">node</h1>

    <form action="/note/{{ uuid }}" method="post" enctype="multipart/form-data">
        <div class="form-group">
            <select name="content_type" id="content_type" onchange="showContentInput()" class="btn">
                <option value="url">URL Link</option>
                <option value="text">Text Note</option>
                <option value="image">Image Upload</option>
            </select>
        </div>

        <div id="url-input" class="form-group">
            <input type="url" id="url-content" name="url_content" placeholder="Enter URL" class="modern-input">
        </div>

        <div id="text-input" class="form-group" style="display: none;">
            <textarea id="text-content" name="text_content" rows="4" placeholder="Type your note here..." class="modern-input"></textarea>
        </div>

        <div id="image-input" class="form-group" style="display: none;">
            <label for="image" class="file-upload-btn">
                Choose Image
                <input type="file" id="image" name="image" accept="image/*" style="display: none;">
            </label>
            <div id="file-name" class="file-name"></div>
        </div>

    <input type="hidden" id="content" name="content" value="">
    <button type="submit" class="btn">Attach Content</button>
</form>

<script>
// Show file name when a file is selected
document.getElementById('image').addEventListener('change', function(e) {
    const fileName = e.target.files[0]?.name || 'No file selected';
    document.getElementById('file-name').textContent = fileName;
});

function showContentInput() {
    const contentType = document.getElementById('content_type').value;
    const contentField = document.getElementById('content');
    
    // Hide all input types with fade effect
    document.getElementById('url-input').style.display = 'none';
    document.getElementById('text-input').style.display = 'none';
    document.getElementById('image-input').style.display = 'none';
    
    // Show selected input type with fade effect
    if (contentType === 'url') {
        document.getElementById('url-input').style.display = 'block';
        document.getElementById('url-content').addEventListener('input', function(e) {
            contentField.value = e.target.value;
        });
    } else if (contentType === 'text') {
        document.getElementById('text-input').style.display = 'block';
        document.getElementById('text-content').addEventListener('input', function(e) {
            contentField.value = e.target.value;
        });
    } else if (contentType === 'image') {
        document.getElementById('image-input').style.display = 'block';
        contentField.value = '';
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Set up initial content value for URL (since it's the default selected type)
    const urlInput = document.getElementById('url-content');
    const contentField = document.getElementById('content');
    urlInput.addEventListener('input', function(e) {
        contentField.value = e.target.value;
    });
    
    // Handle form submission
    document.querySelector('form').addEventListener('submit', function(e) {
        const contentType = document.getElementById('content_type').value;
        const contentField = document.getElementById('content');
        
        if (contentType === 'url') {
            contentField.value = document.getElementById('url-content').value;
        } else if (contentType === 'text') {
            contentField.value = document.getElementById('text-content').value;
        }
        // For image type, we don't need to set content as it's handled by the server
    });
});
</script>
{% endblock %}